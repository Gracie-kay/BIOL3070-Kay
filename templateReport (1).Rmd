
---
title: "Final Project"
author: "Gracie Kay"
date: "2025-10-30"
output:
  html_document:
    toc: true
---
# Background
Fruit production in apple trees is influenced by both genetic and environmental factors, including nutrient availability, disease pressure, and canopy structure. One widespread horticultural practice used to improve fruit yield is pruning, which reduces excess branches, increases light penetration, and improves air flow within the canopy. Increased light exposure enhances photosynthetic efficiency in developing fruiting spurs, which can increase total yield or improve fruit quality (Costa et al., 2015). Because pruning directly alters tree architecture, it can change how resources are allocated between vegetative growth and fruit production.

In ecological terms, pruning acts as a structural disturbance that modifies how energy and resources move through the tree system — a concept similar to how connectivity and resource availability shape biological outcomes in the course materials. If pruning improves carbon flow to fruiting structures, then we expect measurable differences in fruit yield between pruned and unpruned trees. In this project, fruit yield was categorized into three levels (1 = minimal, 2 = normal, 3 = adequate), allowing us to quantify how pruning influences this outcome.

## Research Question, Hypothesis, and Test

**Question:** Does pruning apple trees increase fruit yield?  
**Hypothesis:** Pruned trees will produce higher fruit yields than unpruned trees.  
**Test:** One-sided t-test comparing fruit yield between pruning groups.


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = TRUE)
knitr::opts_knit$set(root.dir = getwd())

library(dplyr)
library(ggplot2)
```


## Load and Prepare Data
```{r load}
df <- read.csv("Pruning Data - Sheet1.csv", header = FALSE)

# Rename columns
colnames(df) <- c("treeid", "pruningstatus", "pruningstatus_num", 
                  "sizeofharvest_text", "sizeofharvest")

# Clean and convert numeric yield score
df_clean <- df %>%
  mutate(
    pruningstatus = factor(pruningstatus, levels = c("No", "Yes")),
    sizeofharvest_num = as.numeric(sizeofharvest)
  ) %>%
  filter(
    !is.na(sizeofharvest_num),
    sizeofharvest_num %in% c(1, 2, 3),
    pruningstatus %in% c("No", "Yes")
  )
```

## Figure: Effect of Pruning on Fruit Yield
```{r figure, fig.height=4.5}
ggplot(df_clean, aes(x = pruningstatus, y = sizeofharvest_num, fill = pruningstatus)) +
  
  geom_boxplot(alpha = 0.85, width = 0.6, outlier.shape = NA) +
  geom_jitter(width = 0.12, alpha = 0.6, color = "black", size = 1.8) +
  
  # n-values above each box
  stat_summary(
    fun = function(y) length(y),
    geom = "text",
    aes(label = after_stat(y)),
    vjust = -0.6,
    size = 5
  ) +
  
  # Colorblind-friendly blue/green palette
  scale_fill_manual(values = c("No" = "#1f78b4", "Yes" = "#33a02c")) +
  
  scale_y_continuous(breaks = c(1,2,3), limits = c(1,3)) +
  
  labs(
    title = "Effect of Pruning on Apple Tree Fruit Yield",
    subtitle = "Fruit yield score comparison (1 = low, 3 = high)",
    x = "Pruning Status",
    y = "Fruit Yield Score",
    fill = "Pruned?"
  ) +
  
  theme_minimal(base_size = 17) +
  theme(
    legend.position = "right",
    plot.title = element_text(face = "bold", size = 20),
    plot.subtitle = element_text(size = 14)
  )

```

## References

Costa, G., Humble, G., & Leite, G. (2015). Pruning and training systems for modern apple orchards. Scientia Horticulturae, 194, 311–322.